<div class="content-heading">Afficher les missions</div>
<div class="col-sm-12" *ngIf="hasError">
  <span class="text-center">Impossible de récupérer la liste des missions</span>
</div>
<div class="custom-datatable" *ngIf="!hasError" #tableWrapper>
  <app-ngx-datatable-common
  *ngIf="missionsOrigin.length > 0"
  [ngxDatas]="missionsOrigin"
  (filterCallback)="filterCallback($event)"></app-ngx-datatable-common>
  <div class="total-right">{{ missions?.length }} mission(s) au total</div>
  <div class="clearfix"></div>
  <ngx-datatable #table class='material' [columnMode]="'force'" [headerHeight]="'auto'" [footerHeight]="50" [rowHeight]="'auto'"
    [limit]="currentPageLimit" [rows]='missions' [rowClass]="getRowClass" [messages]="messages" [loadingIndicator]="loadingIndicator">
    <!-- Ambassadeur -->
    <ngx-datatable-column name="Ambassadeur" prop="ambassador" [sortable]="false" [resizeable]="false">
      <ng-template let-column="column" ngx-datatable-header-template>
        <span class="header-title">Ambassadeur</span>
        <app-ngx-datatable-filter [ngxDatas]="missionsOrigin" [filterList]="filterList.ambassador" [sortBy]="'ambassador'" *ngIf="missionsOrigin.length > 0"></app-ngx-datatable-filter>
      </ng-template>
    </ngx-datatable-column>
    <!-- Communes -->
    <ngx-datatable-column name="Communes" prop="towns" editable="false" [sortable]="false" [resizeable]="false">
      <ng-template let-column="column" ngx-datatable-header-template>
        <span class="header-title">Communes</span>
        <app-ngx-datatable-filter [ngxDatas]="missionsOrigin" [filterList]="filterList.town" [searchContains]="true" [sortBy]="'townsF'" *ngIf="missionsOrigin.length > 0"></app-ngx-datatable-filter>
      </ng-template>
      <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
        <span class="show" [innerHTML]="value" [tooltip]="getTooltipText(row)" placement="right" container="body"></span>
      </ng-template>
    </ngx-datatable-column>
    <!-- Status -->
    <ngx-datatable-column name="Status" prop="status" editable="false" [sortable]="false" [resizeable]="false"
      [maxWidth]="120" [minWidth]="120">
      <ng-template let-column="column" ngx-datatable-header-template>
        <span class="header-title">Status</span>
        <app-ngx-datatable-filter [ngxDatas]="missionsOrigin" [filterList]="filterList.status" [searchContains]="true" [sortBy]="'status'" *ngIf="missionsOrigin.length > 0"></app-ngx-datatable-filter>
      </ng-template>
    </ngx-datatable-column>
    <!-- Du -->
    <ngx-datatable-column name="Du" prop="startDateF" editable="false" [sortable]="true" [resizeable]="false"
      [maxWidth]="120" [minWidth]="120">
      <ng-template let-column="column" ngx-datatable-header-template>
        <span class="header-title">Du</span>
        <app-ngx-datatable-filter [ngxDatas]="missionsOrigin" [sortBy]="'startDate'" [searchByDate]="true" *ngIf="missionsOrigin.length > 0"></app-ngx-datatable-filter>
      </ng-template>
    </ngx-datatable-column>
    <!-- Au -->
    <ngx-datatable-column name="Au" prop="endDateF" editable="false" [sortable]="true" [resizeable]="false" [maxWidth]="120"
      [minWidth]="120">
      <ng-template let-column="column" ngx-datatable-header-template>
        <span class="header-title">Au</span>
        <app-ngx-datatable-filter [ngxDatas]="missionsOrigin" [sortBy]="'endDate'" [searchByDate]="true" *ngIf="missionsOrigin.length > 0"></app-ngx-datatable-filter>
      </ng-template>
    </ngx-datatable-column>
    <!-- ACTIONS -->
    <ngx-datatable-column name="Actions" prop="action" editable="false" [sortable]="false" [resizeable]="false"
      [cellClass]="'action-icons smaller-padding'" [maxWidth]="85" [minWidth]="85">
      <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
        <!-- DELETE -->
        <button class="btn btn-default btn-sm icon btn-mu">
          <i class="fas fa-pencil-alt"></i>
        </button>
        <!-- ADD -->
        <button class="btn btn-default btn-sm icon btn-mu btn-fa-trash-alt">
          <i class="fas fa-trash-alt"></i>
        </button>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-footer>
      <ng-template ngx-datatable-footer-template let-rowCount="rowCount" let-pageSize="currentPageLimit"
        let-selectedCount="selectedCount" let-curPage="curPage" let-offset="offset" let-isVisible="isVisible">
        <datatable-pager [pagerLeftArrowIcon]="'datatable-icon-left'" [pagerRightArrowIcon]="'datatable-icon-right'"
          [pagerPreviousIcon]="'datatable-icon-prev'" [pagerNextIcon]="'datatable-icon-skip'" [page]="curPage" [size]="currentPageLimit"
          [count]="rowCount" [hidden]="false" (change)="table.onFooterPage($event);updatePager($event)">
        </datatable-pager>
        <div class="datatable-pager page-limit">
          <ul id="per-page" class="pager">
            <li *ngFor="let option of pageLimitOptions" (click)="onLimitChange(option.value)" class="pages" [ngClass]="{ 'active': currentPageLimit === option.value }">
              <a href="javascript:void(0);">{{ option.value }}</a>
            </li>
          </ul>
        </div>
      </ng-template>
    </ngx-datatable-footer>
  </ngx-datatable>
</div>
